{
  "system": "You are an objective, conservative code reviewer. Provide concise, high-signal comments with code-specific suggestions and short examples. Prefer deterministic, reproducible guidance. Do NOT speculate beyond the diff context. Do not hallucinate or assume unknown project constraints.",
  "per_file": {
    "template": "Given this unified diff and minimal surrounding context for file `{filename}` (language: {language}), identify specific, actionable issues.\n\n{rubric}\n\nDiff:\n```\n{diff}\n```\n\n{context_section}\n\nRespond strictly as a JSON array. Each element must have these fields:\n- file (string): filename\n- line (integer): line number in the new file\n- severity (string): one of \"info\", \"warn\", \"error\"\n- category (string): e.g. \"security\", \"bug\", \"style\", \"performance\", \"correctness\"\n- message (string): concise explanation\n- suggestion (string or null): optional code fix\n\nReturn [] if no issues found. Do NOT wrap in markdown.",
    "rubrics": {
      "terraform": "- Use `for_each` over `count` for stable addressing.\n- Avoid hardcoded provider versions; use required_providers.\n- Flag `0.0.0.0/0` in security groups.\n- Ensure remote state is encrypted.\n- Prefer data sources over hardcoded IDs.",
      "ansible": "- Prefer built-in modules over shell/command.\n- Use `become` only when required.\n- Avoid `ignore_errors: yes` without justification.\n- Pin collection versions.\n- Use `no_log: true` for sensitive tasks.",
      "yaml": "- Consistent indentation (2 spaces).\n- Quote strings that look like booleans or numbers.\n- Avoid duplicate keys.\n- Use anchors/aliases to reduce repetition.",
      "python": "- Follow PEP 8 naming and style.\n- Avoid bare `except:` clauses.\n- Do not use `eval()` or `exec()` on untrusted input.\n- Prefer `subprocess.run()` with `shell=False`.\n- Use type hints for public functions.\n- Avoid mutable default arguments.",
      "bash": "- Use `set -euo pipefail` at the top.\n- Quote all variable expansions.\n- Avoid `eval` on untrusted input.\n- Prefer `[[ ]]` over `[ ]` for tests.\n- Use `mktemp` for temporary files."
    }
  },
  "summary": {
    "template": "You are summarizing an AI code review for a Pull Request.\n\nPR: {pr_title} (#{pr_number})\nAuthor: {pr_author}\nFiles changed: {files_changed}\nAdditions: +{additions}, Deletions: -{deletions}\n\nReview findings:\n{findings_summary}\n\nProduce a concise PR-level summary with:\n1. **Top Issues** (up to 5, severity-ordered)\n2. **Notable Strengths** (if any)\n3. **Checklist** of items for the author\n\nKeep under 200 lines. Use Markdown formatting."
  },
  "language_map": {
    ".tf": "terraform",
    ".tfvars": "terraform",
    ".hcl": "terraform",
    ".yml": "yaml",
    ".yaml": "yaml",
    ".py": "python",
    ".pyi": "python",
    ".sh": "bash",
    ".bash": "bash",
    ".zsh": "bash",
    ".ksh": "bash"
  },
  "ansible_path_markers": ["roles/", "playbooks/", "tasks/", "handlers/", "group_vars/", "host_vars/"]
}
